<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="io.choerodon.devops.infra.mapper.DevopsAppServiceResourceMapper">
    <select id="queryResourceIdsInApp" resultType="Long">
        SELECT dar.resource_id
        FROM devops_app_service_resource dar
        WHERE dar.resource_type = #{resourceType}
        AND dar.app_service_id = #{appServiceId}
        AND dar.resource_id IN
        <foreach collection="resourceIds" item="resourceId" open="(" close=")" separator=",">
            #{resourceId}
        </foreach>
    </select>

    <select id="countRelatedResource" resultType="int">
        SELECT count(1)
        FROM devops_app_service_resource dasr
        WHERE dasr.app_service_id = #{appServiceId}
    </select>
</mapper>